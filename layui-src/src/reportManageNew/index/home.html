<%@ page language="java" contentType="text/html; charset=UTF-8"
  pageEncoding="UTF-8"%>
<%@include file="/context/mytags.jsp"%>
<%@include file="/context/easyui.jsp"%>
<%@include file="/context/layuiCommon.jsp"%>
<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta http-equiv="X-UA-Compatible" content="ie=edge">
  <title></title>
  <link rel="stylesheet" type="text/css" href="plug-in/assets/css/common.css" />
  <script type="text/javascript" src="plug-in/assets/js/common.js"></script>
  <script type="text/javascript" src="plug-in/Highcharts-5.0.14/code/highcharts.js"></script>

  <!-- <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta http-equiv="X-UA-Compatible" content="ie=edge">
  <title></title>
  <link rel="stylesheet" type="text/css" href="../../easyui-1.5.5.2/easyui.css">
  <link rel="stylesheet" type="text/css" href="../../easyui-1.5.5.2/icon.css">
  <link rel="stylesheet" type="text/css" href="../../easyui-1.5.5.2/demo.css">
  <link rel="stylesheet" href="../../css/layui.css">
  <link rel="stylesheet" href="../../assets/css/common.css">

  <script type="text/javascript" src="../../easyui-1.5.5.2/jquery.min.js"></script>
  <script type="text/javascript" src="../../easyui-1.5.5.2/jquery.easyui.min.js"></script>
  <script type="text/javascript" src="../../easyui-1.5.5.2/datagrid-detailview.js"></script>
  <script type="text/javascript" src="../../serializajson/jquery.serializejson.min.js"></script>
  <script type="text/javascript" src="../../easyui-1.5.5.2/index.js"></script>
  <script type="text/javascript" src="../../Highcharts-5.0.14/code/highcharts.js"></script>
  <script src="../../layui.js"></script>
  <script src="../../assets/js/common.js"></script> -->

  <style>
    .header>img {
      margin-right: 10px;
    }

    .header>p {
      margin: 20px 0 10px;
    }

    .unReturn {
      border: none;
      margin-right: 0;
    }

    .process-box {
      background: #66FFFF;
      border: 1px solid #666;
      margin-top: 20px;
      padding: 5px;
    }

    .process {
      display: flex;
      display: -webkit-flex;
      /* justify-content: center; */
      align-items: center;
      flex-wrap: wrap;
    }

    .process>div {
      /* flex: 1;
      width: 0; */
    }

    .process-content p {
      white-space: nowrap;
    }

    .process-content-span {
      position: relative;
      display: inline-block;
    }

    .process-content-span span {
      position: absolute;
      top: 0;
      right: 0;
      background: #ef5889;
      color: #fff;
      width: 20px;
      height: 20px;
      line-height: 20px;
      padding: 1px;
    }

    .process-content-span b {
      position: absolute;
      top: 50%;
      right: 0;
    }

    .detail-header {
      padding: 20px 0;
    }

    .detail-header .rf i.abtn {
      padding: 3px 18px;

    }

    .detail-header .rf i.abtn.abtn-bg {
      background: #E8FFFF;
    }

    .myDetail-item {
      display: inline-block;
      color: #fff;
    }

    .myDetail-item>div {
      margin: 5px;
      padding: 0px 0px 2px 10px;
    }

    .myDetail-item .rf .abtn,
    .detail-header .rf .abtn {
      background: #fff;
      font-style: normal;
      padding: 2px 5px;
      float: left;
      text-align: center;
      border: 1px solid #666666;
    }

    .myDetail-item .rf .abtn:first-child,
    .detail-header .rf .abtn:not(:last-child) {
      border-right: none;
    }

    .myDetail-item .rf .abtn.abtn-bg {
      background: #66FFFF;
    }

    .myDetail-item>div>.text-center {
      margin: 8px auto 14px;
      font-size: 18px;

    }
  </style>
</head>

<body>
  <div class="layui-container">
    <div class="layui-row layui-col-space15">
      <div class="layui-col-xs9">
        <div class="layui-row">
          <div class="layui-col-xs10 header">
            <img class="lf" src="../../assets/images/user.png">
            <p><span>hi</span> 超级用户,下午好！欢迎登录“博试云”试验检测管理信息系统。</p>
            <h3>当前角色：<span>收样员</span>
              <u class="layui-color-blue">切换角色</u>
              <u class="layui-color-blue">修改密码</u>
              <u class="layui-color-blue">退出系统</u>
              <u class="layui-color-blue">帮助视频</u>
              <u class="layui-color-blue">帮助系统</u>
            </h3>
          </div>
          <div class="layui-col-xs2 text-right">
            <u class="layui-color-blue">原工作台模式</u>
          </div>
        </div>

        <div class="process-box">
          <h4 class="detail-header">检测业务主流程</h4>
          <!-- <blockquote class="layui-elem-quote layui-quote-nm">检测业务主流程</blockquote> -->
          <div class="process" id="process">
            <!-- <div class="process-content" onclick="jumpPage()">
              <div class="text-center">
                <div class="process-content-span">
                  <img class="layui-circle" src="../../assets/images/home_01.png">
                  <span class="layui-circle">12</span>
                </div>
                <p>委托托托收样</p>
              </div>
            </div>
            <div>
              <b class="layui-btn layui-btn-sm layui-btn-primary unReturn">
                <i class="layui-icon">&#xe65c;</i>
              </b>
            </div> -->
          </div>
        </div>

        <h4 class="detail-header">收样信息</h4>

        <div class="layui-row " id="myDetail">
          <!-- <div class="myDetail-item" style="width: 25%;">
            <div style="background:red">
              <div>
                <span>${v.name}</span>
                <a href="#" class="rf" onclick="myTabs(event)">
                  <i class="abtn layui-bg-blue"> 月</i>
                  <i class="abtn"> 年</i>
                </a>
              </div>
              <p class="text-center"> <b>${v.numFrist}</b> ( <b>${v.numlast}</b> ) </p>
              <h4>查看详情&gt;&gt;<span class="rf">退回（${ v.numBreack}）</span></h4>
            </div>
          </div> -->
        </div>

        <h4 class="detail-header">收样统计图
          <a class="rf" onclick="InitObj.headerTabs(event,'收样统计图')">
            <i class="abtn"> 日</i>
            <i class="abtn"> 月</i>
            <i class="abtn abtn-bg"> 年</i>
          </a>
        </h4>
        <div>
          <div id="chartLine" style="min-width:400px;height:400px"></div>
        </div>
        <h4 class="detail-header">收费统计统计图
          <a class="rf" onclick="InitObj.headerTabs(event,'收费统计图')">
            <i class="abtn"> 日</i>
            <i class="abtn"> 月</i>
            <i class="abtn abtn-bg"> 年</i>
          </a>
        </h4>
        <div>
          <div id="chartColumn" style="min-width:400px;height:400px"></div>
        </div>

        <h4 class="detail-header">任务情况 </h4>
        <div>
          <div id="taskUl" style="min-width:400px;height:400px">
            <ul>
              <li>RW2018-28-001 <em>（要求报告日期即将到期，请尽快处理）</em><span class="rf">2018-11-21</span></li>
              <li>RW2018-28-001 <em>（要求报告日期）</em><span class="rf">2018-11-21</span></li>
              <li>RW2018-28-001 <em>（要求报告日期即将到期，请尽快处理）</em><span class="rf">2018-11-21</span></li>
              <li>RW2018-28-001 <em>（要求报告日理）</em><span class="rf">2018-11-21</span></li>

            </ul>
          </div>
        </div>
        <h4 class="detail-header">人员情况</h4>
        <div>
          <div id="criclePie" style="min-width:400px;height:400px"></div>
        </div>

        <div>5</div>
      </div>

      <div class="layui-col-xs3">
        <h4>通知 <u class="layui-color-blue rf">更多通知</u> </h4>
        <div class="layui-collapse" lay-accordion="" lay-filter="test" id="collapse">
          <!-- <div class="layui-colla-item">
            <h2 class="layui-colla-title ">2018-11-10 系统升级通知</h2>
            <div class="layui-colla-content ">
              <h5>尊敬的ilis用户：</h5>
              <p style="text-indent:2em;">
                感谢您对ilis的厚爱，由于软件一些功能优化需要系统升级，我们将在2018-09-28
                18:30开始对软件进行升级维护，过程大约3个小时，在此过程中将无法访问系统。给您造成的不便实属抱歉，感谢您的支持与配合！系统升级以后，登入软件使用时还请清理下浏览器缓存（浏览器历史浏览记录）以免影响一些功能的正常显示和使用，还麻烦各位相互转告下
                非常感谢 ！
              </p>
              <h5 class="text-right">ilis组</h5>
              <h5 class="text-right">2018年05月11日</h5>
            </div>
          </div> -->
        </div>
        <h4 class="text-center"> <u class="layui-color-blue ">更多通知</u> </h4>


      </div>

    </div>

  </div>

  <script src="./home.js"></script>

  <script>
    //注意：折叠面板 依赖 element 模块，否则无法进行功能性操作
    layui.use(['element', 'form'], function () {
      var element = layui.element;
      var form = layui.form;
      InitObj.init(element)
    });
    var InitObj = {
      elementLayerM: null,
      noticeArr: noticeArr,
      processArr: processArr,
      detailArr: detailArr,
      chartLine: null,
      chartColumn: null,
      criclePie: null,
      init: function (element) {
        this.elementLayerM = element
        this.styleLayout(element)
        this.collapseHtml()
        this.processHtml()
        this.detailHtml()
        this.ajaxFun()
        this.optionsData()
      },
      optionsData: function () {
        Highcharts.setOptions({
          // colors: ['#058DC7', '#50B432', '#ED561B', '#DDDF00', '#24CBE5', '#64E572',
          //   '#FF9655', '#FFF263', '#6AF9C4'],
          chart: {
            backgroundColor: {
              linearGradient: [0, 0, 500, 500],
              stops: [
                [0, 'rgb(255, 255, 255)'],
                // [0, 'rgb(255, 0, 0)'],
                [1, 'rgb(240, 240, 255)']
              ]
            },
            borderWidth: 2,
            plotBackgroundColor: 'rgba(255, 255, 255, .9)',
            // plotBackgroundColor: 'rgba(255, 255, 0, .8)',
            plotShadow: true,
            plotBorderWidth: 10,
            style: {
              fontFamily: "",
              fontSize: '22px',
              fontWeight: 'bold',
              color: 'red'
            },
          },
          credits: {
            enabled: false     //不显示LOGO 
          }
        });
        this.chartLine = {
          chart: {
            type: 'line'
          },
          title: {
            text: ''
          },
          colors: ['#4472C4', '#ED7D31'],
          xAxis: {
            categories: ['一月', '二月', '三月', '四月', '五月', '六月', '七月', '八月', '九月', '十月', '十一月', '十二月']
          },
          yAxis: {
            title: {
              text: '委托单数量及样品数量'
            }
          },
          plotOptions: {
            line: {
              dataLabels: {
                // 开启数据标签
                enabled: true
              },
              // 关闭鼠标跟踪，对应的提示框、点击事件会失效
              enableMouseTracking: true
            }
          },
          series: [{
            name: '委托单',
            data: [325, 413, 190, 437, 132, 408, 128, 459, 202, 469, 192, 203]
          }, {
            name: '样品',
            data: [368, 413, 186, 434, 131, 404, 123, 458, 201, 466, 187, 203]
          }],
        };

        this.chartColumn = {
          chart: {
            type: 'column'
          },
          title: {
            text: '收费合计'
          },
          colors: ['#4472C4'],
          xAxis: {
            type: 'category',
            categories: [
              '一月', '二月', '三月', '四月', '五月', '六月', '七月', '八月', '九月', '十月', '十一月', '十二月'
            ],
            crosshair: true
          },
          yAxis: {
            title: {
              text: ''
              // text: '人口 (百万)'
            }
          },
          legend: {
            enabled: false
          },
          tooltip: {
            // pointFormat: '人口总量: <b>{point.y:.1f} 百万</b>'
          },
          series: [{
            name: '总人口',
            data: [7127, 36826, 8243, 9198, 23295, 5780, 22524, 18620, 23610, 38247, 28790, 39666],
            dataLabels: {
              enabled: false,
              rotation: -90,
              color: '#FFFFFF',
              align: 'right',
              format: '{point.y:.1f}', // :.1f 为保留 1 位小数
              y: 10
            }
          }]
        }
        this.criclePie = {
          chart: {
            plotBackgroundColor: null,
            plotBorderWidth: null,
            plotShadow: false,
            type: 'pie'
          },
          title: {
            // text: '2018 年浏览器市场份额'
            text: ''
          },
          tooltip: {
            pointFormat: '{series.name}: <b>{point.percentage:.1f}%</b>'
          },
          plotOptions: {
            pie: {
              allowPointSelect: true,
              cursor: 'pointer',
              dataLabels: {
                enabled: false
              },
              showInLegend: true
            }
          },
          series: [{
            name: 'Brands',
            colorByPoint: true,
            data: [{
              name: 'Chrome',
              y: 61.41,
              sliced: true,
              selected: true
            }, {
              name: 'Internet Explorer',
              y: 11.84
            }, {
              name: 'Firefox',
              y: 10.85
            }, {
              name: 'Edge',
              y: 4.67
            }, {
              name: 'Safari',
              y: 4.18
            }, {
              name: 'Other',
              y: 7.05
            }]
          }]
        }
      },
      ajaxFun: function () {
        $.getJSON('../../data/table/demo1.json', function (data) {
          console.log('data', data)
          var options = InitObj.chartLine;
          var options2 = InitObj.chartColumn;
          var options3 = InitObj.criclePie;
          if (data.length === 0) {
            options.series[0].data = []
            $.each(data, function (i, v) {
              options.series[0].data.push(v.number)
            })
          }

          Highcharts.chart('chartLine', options);
          Highcharts.chart('chartColumn', options2);
          Highcharts.chart('criclePie', options3);
          // new Highcharts.Chart('chartColumn', options2);
        });
      },

      detailHtml: function () {
        var widths = $('#myDetail').width(), len = this.detailArr.length;
        var colWidth = (widths / len) / widths * 100;
        console.log('colWidth', colWidth)
        var html = ''
        $.each(this.detailArr, function (i, v) {
          html += `<div class="myDetail-item" style="width: ${colWidth}%;">
            <div style="background:${v.bg};">
              <div>
                <span>${v.name}</span>
                <a href="#" class="rf" onclick="InitObj.myTabs(event)">
                  <i class="abtn abtn-bg">月</i>
                  <i class="abtn">年</i>
                </a>
              </div>
              <p class="text-center"> <b>${v.numFrist}</b> ( <b>${v.numlast}</b> ) </p>
              <h4>查看详情&gt;&gt;<span class="rf">退回（${ v.numBreack}）</span></h4>
            </div>
          </div>`
        })

        // $('#myDetail').append(html)
        $('#myDetail').html(html)
      },
      jumpPage: function () {
        console.log('点击了跳转')
      },
      myTabs: function (event) {
        console.log('this', $(this))
        console.log('this', event.target)
        $(event.target).addClass('abtn-bg').siblings().removeClass('abtn-bg')
      },
      headerTabs: function (event) {
        $(event.target).addClass('abtn-bg').siblings().removeClass('abtn-bg')
      },
      processHtml: function () {
        var html = '', len = this.processArr.length - 1;
        console.log(len)
        $.each(this.processArr, function (i, v) {
          console.log(i)
          html += `  <div class="process-content" onclick="InitObj.jumpPage()">
              <div class="text-center">
                <div class="process-content-span">
                  <img class="layui-circle" src="${v.imgs}">
                  <span class="layui-circle">${v.num}</span>
                  
                </div>
                <p>${v.name}</p>
              </div>
            </div>`
          if (len !== i) {
            html += `<div>
              <b class="layui-btn layui-btn-sm layui-btn-primary unReturn">
                <i class="layui-icon">&#xe65c;</i>
              </b>
            </div>`
          }
        })
        $('#process').append(html)
        // $('#process').html(html)
      },
      collapseHtml: function () {
        console.log('noticeArr', this.noticeArr)
        var html = ''
        $.each(this.noticeArr, function (i, v) {
          html += '<div class="layui-colla-item">'
          if (0 === i) {
            html += '  <h2 class="layui-colla-title layui-color-blue">' + v.titleDate + ' ' + v.title + ' </h2>'
            console.log('if', i)
            html += '  <div class="layui-colla-content layui-show">'
          } else {
            html += '  <h2 class="layui-colla-title">' + v.titleDate + ' ' + v.title + ' </h2>'
            console.log('else', i)
            html += '  <div class="layui-colla-content ">'
          }
          html += '    <h5>' + v.textTitle + '</h5>'
          html += '   <p style="text-indent:2em;">' + v.textContent + '    </p>'
          html += '   <h5 class="text-right">' + v.textName + '</h5>'
          html += '   <h5 class="text-right">' + v.textDate + '</h5>'
          html += '  </div>'
          html += '</div>'

        })
        $('#collapse').append(html)
        this.elementLayerM.render()
      },
      styleLayout: function (element) {
        element.on('collapse(test)', function (data) {
          console.log(data.show); //得到当前面板的展开状态，true或者false
          // if (data.show) {
          data.title.addClass('layui-color-blue').parent().siblings().children('.layui-colla-title').removeClass('layui-color-blue')
          // }
          console.log(data.title); //得到当前点击面板的标题区域DOM对象
          console.log(data.content); //得到当前点击面板的内容区域DOM对象
        });
      },
    }
  </script>

</body>

</html>